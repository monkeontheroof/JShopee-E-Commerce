<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	  xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3"
	  xmlns:layout="http://www.w3.org/1999/xhtml">
	<head>
		<!-- Meta -->
		<meta charset="utf-8">
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
		<meta name="description" content="">
		<meta name="author" content="">
	    <meta name="keywords" content="MediaCenter, Template, eCommerce">
	    <meta name="robots" content="all">

	    <title>My cart</title>

		<!-- Bootstrap Core CSS -->
		<link rel="stylesheet" th:href="@{assets/css/bootstrap.min.css}">

		<!-- Customizable CSS -->
		<link rel="stylesheet" th:href="@{assets/css/main.css}">
		<link rel="stylesheet" th:href="@{assets/css/blue.css}">
		<link rel="stylesheet" th:href="@{assets/css/owl.carousel.css}">
		<link rel="stylesheet" th:href="@{assets/css/owl.transitions.css}">
		<link rel="stylesheet" th:href="@{assets/css/animate.min.css}">
		<link rel="stylesheet" th:href="@{assets/css/rateit.css}">
		<link rel="stylesheet" th:href="@{assets/css/bootstrap-select.min.css}">

		<!-- Icons/Glyphs -->
		<link rel="stylesheet" th:href="@{assets/css/font-awesome.css}">

        <!-- Fonts --> 
		<link href='http://fonts.googleapis.com/css?family=Roboto:300,400,500,700' rel='stylesheet' type='text/css'>
		<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,400italic,600,600italic,700,700italic,800' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>


	</head>
    <body class="cnt-home">
		<!-- ============================================== HEADER ============================================== -->
		<header th:replace="fragments/navbarHome :: navbarHome">

		</header>

<!-- ============================================== HEADER : END ============================================== -->
<div class="breadcrumb">
	<div class="container">
		<div class="breadcrumb-inner">
			<ul class="list-inline list-unstyled">
				<li><a href="#">Home</a></li>
				<li class='active'>Shopping Cart</li>
			</ul>
		</div><!-- /.breadcrumb-inner -->
	</div><!-- /.container -->
</div><!-- /.breadcrumb -->

<div class="body-content outer-top-xs">
	<div class="container">
		<div class="row ">
			<div class="shopping-cart">
				<div class="shopping-cart-table ">
	<div class="table-responsive">
		<div th:if="${cart} == null"></div>
		<table class="table">
			<thead>
				<tr>
					<th></th>
					<th class="cart-description item">Image</th>
					<th class="cart-product-name item">Product Name</th>
					<th class="cart-sub-total item">Subtotal</th>
					<th class="cart-total last-item">Grand total</th>
					<th class="cart-qty item">Quantity</th>
					<th class="cart-qty item">Coupon</th>
					<th class="cart-qty item">Update</th>
					<th class="cart-romove item">Remove</th>
				</tr>
			</thead><!-- /thead -->
			<tfoot>
				<tr>
					<td colspan="3">
						<div class="shopping-cart-btn">
							<span class="">
								<a th:href="@{/}" class="btn btn-upper btn-primary pull-right outer-right-xs" value="update">Continue Shopping</a>
							</span>
						</div><!-- /.shopping-cart-btn -->
					</td>
				</tr>
			</tfoot>
			<tbody th:if="${cart != null}">
				<tr th:each="item, iStat: ${cart.getCartItems()}">
					<form th:action="@{/update-cart}" method="post">
						<td>
							<p th:text="${iStat.index + 1}"></p>
						</td>
					<td >
						<a th:href="@{/shop/viewProduct/{id}(id=${item.product.id})}">
						    <img height="50px" th:src="@{${'/productImages/' + item.product.images.get(0).imageName}}" alt="">
						</a>
					</td>
					<td class="cart-product-name-info">
						<h5 class='cart-product-description'><a th:href="@{/shop/viewProduct/{id}(id=${item.product.id})}" th:text="${item.product.name}">Cart item name</a></h5>
						<div class="row">
							<div class="col-sm-4">
								<div class="rating rateit-small"></div>
							</div>
							<div class="col-sm-8">
								<div class="reviews" th:text="${item.product.reviews.size()} + ' Reviews'">
									(06 Reviews)
								</div>
							</div>
						</div><!-- /.row -->
<!--						<div class="cart-product-info">-->
<!--											<span class="product-color">COLOR:<span>Blue</span></span>-->
<!--						</div>-->
					</td>
					<td class="cart-product-sub-total"><span class="cart-sub-total-price total-price"  th:text="${formatter.format(item.product.price)}">$300.00</span></td>
					<td class="cart-product-grand-total"><span class="cart-grand-total-price" th:text="${formatter.format(item.totalPrice)}">$300.00</span></td>

					<td class="cart-product-quantity">
							<div class="quant-input">
								<div class="arrows">
									<div class="arrow plus gradient increase-quantity" data-product-id="[[${item.product.id}]]" data-cart-item-id="${iStat}">
										<span class="ir"><i class="icon fa fa-sort-asc"></i></span>
									</div>
									<div class="arrow minus gradient decrease-quantity" data-product-id="[[${item.product.id}]]" data-cart-item-id="${iStat}">
										<span class="ir"><i class="icon fa fa-sort-desc"></i></span>
									</div>
								</div>
								<input type="hidden" name="productId" th:value="${item.product.id}">
								<input type="text" name="quantity" class="quantity" th:value="${item.quantity}" min="1" step="1" max="999">
							</div>
					</td>
						<td>
							<input type="text" id="voucherCode" name="voucherCode" th:if="${item.voucher ne null}" th:value="${item.voucher.code}">
							<input type="text" id="voucherCode" name="voucherCode" th:unless="${item.voucher ne null}" placeholder="Enter voucher code">
						</td>
					<td>
						<div class="" style="display: flex; gap: 10px">
							<button type="submit" name="action" value="update" title="Update" class="btn btn-primary">
								<!--                                                        <i class="fas fa-trash-alt mr-1"></i> -->
								Update
							</button>
						</div>
					</td>
						<td class="remove-item">
							<button type="submit" name="action" value="delete" title="Delete" class="btn btn-danger">
								<i class="fa fa-trash-o"></i>
							</button>
						</td>
					</form>
				</tr>
			</tbody><!-- /tbody -->
		</table><!-- /table -->
	</div>
</div><!-- /.shopping-cart-table -->



<div class="col-md-12 col-sm-12 cart-shopping-total">
	<div class="container">
		<h4 class="mt-4"></h4>
		<div class="row">
			<div class="col-md-6">
				<table class="table table-bordered">
					<tbody>
					<tr>
						<td><strong>Thành tiền:</strong></td>
						<td th:text="${formatter.format(cart.getTotalPrice())} + ' đ'">0.00 đ</td>
					</tr>
					<!-- Add more rows for additional summary information -->
					<tr>
						<td><strong>Thuế:</strong></td>
						<td>4 %</td>
					</tr>
					<tr>
						<td><strong>Phí giao hàng:</strong></td>
						<td>50.000 đ</td>
					</tr>
					<tr>
						<td><strong>Tổng tiền:</strong></td>
						<td th:text="${formatter.format(cart.totalPrice + (cart.totalPrice * 0.04) + 30000)}">$0.00</td>
					</tr>
					</tbody>
				</table>
			</div>
			<div class="col-md-6">
				<!-- Checkout Button -->
				<a class="btn btn-primary btn-lg" th:href="@{/check-out}">Tiến hành thanh toán</a>
			</div>
		</div>
	</div>
</div><!-- /.cart-shopping-total -->			</div><!-- /.shopping-cart -->
		</div> <!-- /.row -->
		<!-- ============================================== BRANDS CAROUSEL ============================================== -->
<div id="brands-carousel" class="logo-slider wow fadeInUp">

		<div class="logo-slider-inner">	
			<div id="brand-slider" class="owl-carousel brand-slider custom-carousel owl-theme">
				<div class="item m-t-15">
					<a href="#" class="image">
						<img data-echo="assets/images/brands/brand1.png" src="assets\images\blank.gif" alt="">
					</a>	
				</div><!--/.item-->

				<div class="item m-t-10">
					<a href="#" class="image">
						<img data-echo="assets/images/brands/brand2.png" src="assets\images\blank.gif" alt="">
					</a>	
				</div><!--/.item-->

				<div class="item">
					<a href="#" class="image">
						<img data-echo="assets/images/brands/brand3.png" src="assets\images\blank.gif" alt="">
					</a>	
				</div><!--/.item-->

				<div class="item">
					<a href="#" class="image">
						<img data-echo="assets/images/brands/brand4.png" src="assets\images\blank.gif" alt="">
					</a>	
				</div><!--/.item-->

				<div class="item">
					<a href="#" class="image">
						<img data-echo="assets/images/brands/brand5.png" src="assets\images\blank.gif" alt="">
					</a>	
				</div><!--/.item-->

				<div class="item">
					<a href="#" class="image">
						<img data-echo="assets/images/brands/brand6.png" src="assets\images\blank.gif" alt="">
					</a>	
				</div><!--/.item-->

				<div class="item">
					<a href="#" class="image">
						<img data-echo="assets/images/brands/brand2.png" src="assets\images\blank.gif" alt="">
					</a>	
				</div><!--/.item-->

				<div class="item">
					<a href="#" class="image">
						<img data-echo="assets/images/brands/brand4.png" src="assets\images\blank.gif" alt="">
					</a>	
				</div><!--/.item-->

				<div class="item">
					<a href="#" class="image">
						<img data-echo="assets/images/brands/brand1.png" src="assets\images\blank.gif" alt="">
					</a>	
				</div><!--/.item-->

				<div class="item">
					<a href="#" class="image">
						<img data-echo="assets/images/brands/brand5.png" src="assets\images\blank.gif" alt="">
					</a>	
				</div><!--/.item-->
		    </div><!-- /.owl-carousel #logo-slider -->
		</div><!-- /.logo-slider-inner -->
	
</div><!-- /.logo-slider -->
<!-- ============================================== BRANDS CAROUSEL : END ============================================== -->	</div><!-- /.container -->
</div><!-- /.body-content -->

<!-- ============================================================= FOOTER ============================================================= -->
<footer id="footer" class="footer color-bg">


    <div class="footer-bottom">
        <div class="container">
            <div class="row">
                <div class="col-xs-12 col-sm-6 col-md-3">
                    <div class="module-heading">
                        <h4 class="module-title">Contact Us</h4>
                    </div><!-- /.module-heading -->

                    <div class="module-body">
        <ul class="toggle-footer" style="">
            <li class="media">
                <div class="pull-left">
                     <span class="icon fa-stack fa-lg">
                            <i class="fa fa-map-marker fa-stack-1x fa-inverse"></i>
                    </span>
                </div>
                <div class="media-body">
                    <p>ThemesGround, 789 Main rd, Anytown, CA 12345 USA</p>
                </div>
            </li>

              <li class="media">
                <div class="pull-left">
                     <span class="icon fa-stack fa-lg">
                      <i class="fa fa-mobile fa-stack-1x fa-inverse"></i>
                    </span>
                </div>
                <div class="media-body">
                    <p>+(888) 123-4567<br>+(888) 456-7890</p>
                </div>
            </li>

              <li class="media">
                <div class="pull-left">
                     <span class="icon fa-stack fa-lg">
                      <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                    </span>
                </div>
                <div class="media-body">
                    <span><a href="#">flipmart@themesground.com</a></span>
                </div>
            </li>
              
            </ul>
    </div><!-- /.module-body -->
                </div><!-- /.col -->

                <div class="col-xs-12 col-sm-6 col-md-3">
                    <div class="module-heading">
                        <h4 class="module-title">Customer Service</h4>
                    </div><!-- /.module-heading -->

                    <div class="module-body">
                        <ul class='list-unstyled'>
                            <li class="first"><a href="#" title="Contact us">My Account</a></li>
                <li><a href="#" title="About us">Order History</a></li>
                <li><a href="#" title="faq">FAQ</a></li>
                <li><a href="#" title="Popular Searches">Specials</a></li>
                <li class="last"><a href="#" title="Where is my order?">Help Center</a></li>
                        </ul>
                    </div><!-- /.module-body -->
                </div><!-- /.col -->

                <div class="col-xs-12 col-sm-6 col-md-3">
                    <div class="module-heading">
                        <h4 class="module-title">Corporation</h4>
                    </div><!-- /.module-heading -->

                    <div class="module-body">
                        <ul class='list-unstyled'>
                          <li class="first"><a title="Your Account" href="#">About us</a></li>
                <li><a title="Information" href="#">Customer Service</a></li>
                <li><a title="Addresses" href="#">Company</a></li>
                <li><a title="Addresses" href="#">Investor Relations</a></li>
                <li class="last"><a title="Orders History" href="#">Advanced Search</a></li>
                        </ul>
                    </div><!-- /.module-body -->
                </div><!-- /.col -->

                <div class="col-xs-12 col-sm-6 col-md-3">
                    <div class="module-heading">
                        <h4 class="module-title">Why Choose Us</h4>
                    </div><!-- /.module-heading -->

                    <div class="module-body">
                        <ul class='list-unstyled'>
                            <li class="first"><a href="#" title="About us">Shopping Guide</a></li>
                <li><a href="#" title="Blog">Blog</a></li>
                <li><a href="#" title="Company">Company</a></li>
                <li><a href="#" title="Investor Relations">Investor Relations</a></li>
                <li class=" last"><a href="contact-us.html" title="Suppliers">Contact Us</a></li>
                        </ul>
                    </div><!-- /.module-body -->
                </div>
            </div>
        </div>
    </div>

    <div class="copyright-bar">
        <div class="container">
            <div class="col-xs-12 col-sm-6 no-padding social">
                <ul class="link">
                  <li class="fb pull-left"><a target="_blank" rel="nofollow" href="#" title="Facebook"></a></li>
                  <li class="tw pull-left"><a target="_blank" rel="nofollow" href="#" title="Twitter"></a></li>
                  <li class="googleplus pull-left"><a target="_blank" rel="nofollow" href="#" title="GooglePlus"></a></li>
                  <li class="rss pull-left"><a target="_blank" rel="nofollow" href="#" title="RSS"></a></li>
                  <li class="pintrest pull-left"><a target="_blank" rel="nofollow" href="#" title="PInterest"></a></li>
                  <li class="linkedin pull-left"><a target="_blank" rel="nofollow" href="#" title="Linkedin"></a></li>
                  <li class="youtube pull-left"><a target="_blank" rel="nofollow" href="#" title="Youtube"></a></li>
                </ul>
            </div>
            <div class="col-xs-12 col-sm-6 no-padding">
                <div class="clearfix payment-methods">
                    <ul>
                        <li><img src="assets\images\payments\1.png" alt=""></li>
                        <li><img src="assets\images\payments\2.png" alt=""></li>
                        <li><img src="assets\images\payments\3.png" alt=""></li>
                        <li><img src="assets\images\payments\4.png" alt=""></li>
                        <li><img src="assets\images\payments\5.png" alt=""></li>
                    </ul>
                </div><!-- /.payment-methods -->
            </div>
        </div>
    </div>
</footer>
<!-- ============================================================= FOOTER : END============================================================= -->


	<!-- For demo purposes – can be removed on production -->
	
	
	<!-- For demo purposes – can be removed on production : End -->

	<!-- JavaScripts placed at the end of the document so the pages load faster -->
		<script th:src="@{assets/js/jquery-1.11.1.min.js}"></script>
		<script th:src="@{assets/js/bootstrap.min.js}"></script>
		<script th:src="@{assets/js/bootstrap-hover-dropdown.min.js}"></script>
		<script th:src="@{assets/js/owl.carousel.min.js}"></script>
		<script th:src="@{/assets/js/echo.min.js}"></script>
		<script th:src="@{/assets/js/jquery.easing-1.3.min.js}"></script>
		<script th:src="@{/assets/js/bootstrap-slider.min.js}"></script>
		<script th:src="@{/assets/js/jquery.rateit.min.js}"></script>
		<script type="text/javascript" th:src="@{/assets/js/lightbox.min.js}"></script>
		<script th:src="@{/assets/js/bootstrap-select.min.js}"></script>
		<script th:src="@{/assets/js/wow.min.js}"></script>
		<script th:src="@{/assets/js/scripts.js}"></script>
		<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
		<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
		<script th:inline="javascript">
			document.addEventListener("DOMContentLoaded", function () {
				var increaseButtons = document.querySelectorAll('.increase-quantity');
				var decreaseButtons = document.querySelectorAll('.decrease-quantity');
				var quantityInputs = document.querySelectorAll('.quantity');
				var totalPriceElements = document.querySelectorAll('.total-price');
				var cartCountElement = document.querySelector('.cartCount');

				increaseButtons.forEach(function (button, index) {
					button.addEventListener('click', function () {
						updateQuantity(index, 1);
					});
				});

				decreaseButtons.forEach(function (button, index) {
					button.addEventListener('click', function () {
						var currentQuantity = parseFloat(quantityInputs[index].value);
						if (currentQuantity > 1) {
							updateQuantity(index, -1);
						}
					});
				});

				async function updateQuantity(index, change) {
					var currentQuantity = parseFloat(quantityInputs[index].value);
					currentQuantity += change;
					quantityInputs[index].value = currentQuantity;

					updateCartCount();
				}

				function updateTotalPrice(index, quantity, initialPrice) {
					var total = initialPrice * quantity;
					totalPriceElements[index].textContent = formatPriceForHTML(total);
				}

				function formatPriceForHTML(price) {
					return price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
				}

				function calculateCartCount() {
					var totalQuantity = 0;

					quantityInputs.forEach(function (input, index) {
						var currentQuantity = parseFloat(input.value);
						var initialPrice = parseFloat(totalPriceElements[index].getAttribute('data-initial-price'));
						totalQuantity += currentQuantity;
						updateTotalPrice(index, currentQuantity, initialPrice);
					});

					return totalQuantity;
				}

				function updateCartCount() {
					if (cartCountElement) {
						cartCount = calculateCartCount();
						cartCountElement.textContent = cartCount;
					}
				}

				updateCartCount();
			});
		</script>
</body>
</html>
